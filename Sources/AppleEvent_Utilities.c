/******************************************\|**| AppleEvent_Utilities.c\******************************************/#pragma mark 본INCLUDES본/******************************************\|**| #includes\******************************************/#pragma mark _system includes_/* - system*******************************************/#include <AppleEvents.h>#pragma mark _third party includes_/* - third party libraries*******************************************/#pragma mark _bp libraries includes_/* - bp libraries*******************************************/#pragma mark _this library includes_/* - this project*******************************************/#include "AppleEvent_Utilities.h"#pragma mark 본DEFINITIONS본/******************************************\|**| #defines\******************************************//* - definitions*******************************************/#define	kFinderType			'FNDR'#define	kFinderCreator		'MACS'#pragma mark _macros_/* - macros*******************************************/#pragma mark 본TYPEDEFS본/******************************************\|**| typedefs\******************************************/#pragma mark 본EXTERNAL GLOBALS본/******************************************\|**| external globals\******************************************/#pragma mark 본PRIVATE GLOBALS본/******************************************\|**| private globals\******************************************/ProcessSerialNumber	*gFinderProcess = nil;#pragma mark 본PRIVATE PROTOTYPES본/******************************************\|**| private function prototypes\******************************************/#pragma mark 본PRIVATE FUNCTIONS본/******************************************\|**| private functions\******************************************/#pragma mark 본PUBLIC FUNCTIONS본/******************************************\|**| public functions\******************************************/void AECreate ( AEDesc *descriptor){	descriptor->descriptorType = typeNull;	descriptor->dataHandle = nil;}void AEDestroy ( AEDesc *descriptor){	OSErr	error;	error = AEDisposeDesc(descriptor);	AECreate(descriptor);}Boolean GetFinderSerialNumber ( void){	ProcessInfoRec	info;	Str63			s;	FSSpec			fs;//	OSErr			error;	long			gv;	Boolean			result = false;		gFinderProcess = (ProcessSerialNumber *)NewPtr( sizeof( ProcessSerialNumber));	if ( gFinderProcess == nil) return( false);		if ((Gestalt(gestaltOSAttr, &gv) == noErr) && (gv & gestaltLaunchControl))	{		gFinderProcess->highLongOfPSN = 0;		gFinderProcess->lowLongOfPSN = kNoProcess;		info.processInfoLength = sizeof(ProcessInfoRec);		info.processName = s;		info.processAppSpec = &fs;		while (( result == false) && (GetNextProcess( gFinderProcess) == noErr))		{			if (GetProcessInformation(gFinderProcess, &info) == noErr)			{				if ((info.processType == kFinderType) &&					(info.processSignature == kFinderCreator))				{					result = true;				}//				mWriteDebugString( info.processName);			}		}	}	return ( result);}